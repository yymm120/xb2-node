## js的同步和异步
- 任务分为同步任务和异步任务，其中异步任务又分为宏任务和微任务。

- 同步任务：又叫做非耗时任务,指的是在主线程执行栈上排队执行的那些任务，只有前一个任务执行完毕,才能执行后一个任务。

- 异步任务：又叫做耗时任务,异步任务由Js委托给**宿主环境**进行执行，当异步任务执行完成后,会通知Js主线程执行异步任务的回调函数。

Js主线程执行栈被清空后会读取"任务队列"中的**各种任务**,放到执行栈中依次执行。这个过程是循环不断的,所以整个的这种运行机制又称为 EventLoop (事件循环)

### 各种任务
宏任务与微任务

宏任务：异步Ajax请求，setTimeout，setInterval，文件操作，new Promise等

微任务：Promise.then、.catch、.finally，process.nextTick等

宏任务与微任务是交替执行的，每次执行完宏任务都会检查是否有微任务

代码示例：
```js
console.log('A');

setTimeout(function() {
console.log('B');
}, 0);

Promise.resolve().then(function() {
console.log('C');
}).then(function() {
console.log('D');
});

console.log('E');
```
先执行同步任务打印A和E，再执行异步任务中的微任务，打印C和D，最后执行宏任务打印B
最终打印结果：AECDB


### 轮询机制
- js执行栈空了，会从任务队列中寻找任务。如何寻找？通过轮询机制，


下面是一个多层次代码，可进行练习：

```js
console.log('1')  // sync

setTimeout(function () {
  console.log('2')  // async: 宏
  process.nextTick(function () {
    console.log('3')  // async: 宏
  })
  new Promise(function (resolve) {
    console.log('4')  // async
     resolve()    // async
   }).then(function () {
     console.log('5') // async
   })
 })
 Promise.resolve().then(function () {
   console.log('6')   // async
 })
 new Promise(function (resolve) {
   console.log('7')   // async
   resolve()    // async
 }).then(function () {
   console.log('8'); // async
 })

 setTimeout(function () {
   console.log('9')   // async
   process.nextTick(function () {
     console.log('10')  // async
   })
   new Promise(function (resolve) {
     console.log('11')
     resolve()
   }).then(function () {
     console.log('12')
   })
 })
```
分析：

最终打印结果：1，7，6，8，2，4，3，5，9，11，10，12